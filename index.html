<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Decuple Stream of Sovereignty: Particle Stream</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Gochi+Hand&family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        'title-serif': ['Playfair Display', 'Georgia', 'serif'],
                        'divine': ['Cinzel Decorative', 'serif'],
                    },
                    colors: {
                        'primary-gold': '#FFD700',
                        'accent-pink': '#EC4899',
                        'durga-red': '#8B0000',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #0c0a09;
            font-family: 'Inter', sans-serif;
            overflow: hidden;
            color: white;
            min-height: 100vh;
        }

        .nav-panel, #mainContent, #navToggleIcon, #navToggleX {
            transition: all 0.3s ease-in-out;
        }
        
        #mainContent, .nav-panel {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        #mainContent::-webkit-scrollbar,
        .nav-panel::-webkit-scrollbar {
            display: none;
        }
        
        .festive-text {
            font-family: 'Gochi Hand', cursive;
        }
        
        .nav-panel-style {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 215, 0, 0.5);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.1);
            color: white;
        }
        
        .nav-panel a.nav-link {
            color: white;
            transition: background-color 0.2s ease, color 0.2s ease;
            font-weight: 700;
        }
        
        .nav-panel a.nav-link:hover {
            background-color: rgba(255, 215, 0, 0.2);
            color: #FFD700;
        }
        
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
        }

        #intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            background: radial-gradient(circle at center, #600000 0%, #300000 50%, #000000 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 1.5s ease-in-out;
            padding: 2rem;
        }
        
        #intro-screen.hidden-intro {
            opacity: 0;
            pointer-events: none;
        }

        .intro-border {
            position: absolute;
            top: 30px;
            left: 30px;
            right: 30px;
            bottom: 30px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            pointer-events: none;
        }
        
        .intro-border-inner {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border: 1px solid rgba(255, 215, 0, 0.15);
        }

        .intro-corner {
            position: absolute;
            width: 60px;
            height: 60px;
            border-color: #FFD700;
            border-style: solid;
            opacity: 0.8;
        }
        
        .tl { top: 30px; left: 30px; border-width: 3px 0 0 3px; }
        .tr { top: 30px; right: 30px; border-width: 3px 3px 0 0; }
        .bl { bottom: 30px; left: 30px; border-width: 0 0 3px 3px; }
        .br { bottom: 30px; right: 30px; border-width: 0 3px 3px 0; }

        #content-overlay {
            position: relative;
            z-index: 20;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 112px); 
            padding: 1rem;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        
        #content-overlay.visible-content {
            opacity: 1;
        }

        .gold-text {
            color: #FFD700;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
        }

        .divine-glow {
            text-shadow: 0 0 20px rgba(255, 69, 0, 0.6), 0 0 40px rgba(255, 215, 0, 0.4);
        }
        
        .stream-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        .stream-container:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(255, 215, 0, 0.4);
        }

        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1em;
            margin-left: 2px;
            background-color: #FFD700;
            animation: blink 0.7s step-end infinite;
        }

        @keyframes blink {
            from, to { background-color: transparent }
            50% { background-color: #FFD700; }
        }
        
        .message-card {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            transition: all 0.5s ease;
            transform: scale(0.9);
            opacity: 0;
            pointer-events: none;
        }
        
        .message-card.active {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }

        .trishul-icon {
            color: #FFD700;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.6));
        }
        
        .reveal-btn {
            background: linear-gradient(45deg, rgba(139, 0, 0, 0.8), rgba(255, 215, 0, 0.2));
            backdrop-filter: blur(5px);
            border: 1px solid #FFD700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
            transition: all 0.4s ease;
        }
        
        .reveal-btn:hover {
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.2), rgba(139, 0, 0, 0.8));
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            transform: scale(1.05);
            letter-spacing: 2px;
        }
    </style>
</head>
<body class="text-white">

    <div id="canvas-container"></div>

    <div id="intro-screen">
        <div class="intro-corner tl"></div>
        <div class="intro-corner tr"></div>
        <div class="intro-corner bl"></div>
        <div class="intro-corner br"></div>
        <div class="intro-border">
            <div class="intro-border-inner"></div>
        </div>

        <div class="text-center p-8 max-w-2xl relative z-10">
            <div class="mb-8 flex justify-center animate-float">
                <svg class="w-32 h-32 trishul-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,2C9,2 7,4 7,7V10C7,13 9,15 12,15C15,15 17,13 17,10V7C17,4 15,2 12,2M12,17C8,17 4,18 4,20V22H20V20C20,18 16,17 12,17Z" />
                    <circle cx="12" cy="12" r="1.5" fill="#8B0000" />
                </svg>
            </div>
            
            <h1 class="text-5xl md:text-7xl font-divine text-primary-gold mb-8 divine-glow tracking-wide">
                The Divine Reflection
            </h1>
            
            <div class="space-y-6 mb-12">
                <p class="text-xl md:text-3xl text-gray-100 leading-relaxed font-title-serif italic">
                    "Just as Ma Durga wields power in her ten hands,<br>
                    you too hold ten distinct gifts."
                </p>
                
                <div class="h-px w-32 bg-gradient-to-r from-transparent via-primary-gold to-transparent mx-auto opacity-50"></div>
                
                <p class="text-lg text-red-200 font-light tracking-wider">
                    EACH HAND DEFINES A SKILL.<br>EACH SKILL DEFINES A PART OF YOUR SOUL.
                </p>
            </div>

            <button onclick="enterExperience()" 
                class="reveal-btn px-12 py-5 text-primary-gold font-bold text-xl rounded-sm uppercase tracking-widest">
                Reveal Your Powers
            </button>
        </div>
    </div>

    <button id="navToggle" class="fixed top-6 left-6 z-[1002] p-2 rounded-full shadow-lg focus:outline-none focus:ring-2 focus:ring-primary-gold focus:ring-offset-2 nav-panel-style transition-opacity duration-1000">
        <svg id="navToggleIcon" class="w-6 h-6 gold-text" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-8 6h8"></path></svg>
        <svg id="navToggleX" class="w-6 h-6 hidden gold-text" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
    </button>

    <nav id="topNav" class="nav-panel fixed top-0 left-0 right-0 z-[1001] h-16 shadow-md flex items-center justify-center space-x-6 -translate-y-full nav-panel-style">
        <a href="index.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Home</a>
        <a href="Special.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Special</a>
        <a href="letter.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Letter</a>
    </nav>

    <nav id="bottomNav" class="nav-panel fixed bottom-0 left-0 right-0 z-[1001] h-16 shadow-md flex items-center justify-center space-x-6 translate-y-full nav-panel-style">
        <a href="anatomy.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Anatomy</a>
        <a href="chat.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Heaven</a>
        <a href="you.html" class="nav-link px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">You</a>
    </nav>

    <nav id="leftNav" class="nav-panel fixed left-0 top-0 bottom-0 z-[1001] w-20 shadow-md flex flex-col items-center space-y-6 -translate-x-full overflow-y-auto py-20 nav-panel-style">
        <a href="Diary.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Diary</a>
        <a href="Universe.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Universe</a>
        <a href="Box.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Box</a>
        <a href="color.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Color</a>
        <a href="Teacher.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Teacher</a>
        <a href="The_River.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">River</a>
        <a href="Mountain.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Mountain</a>
        <a href="Paper_Star.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Paper Star</a>
        <a href="Carttoon.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Cartoon</a>
        <a href="Santa.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Santa</a>
        <a href="Cloud.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Cloud</a>
        <a href="Ink.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Paint</a>
        <a href="Butterfly.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Butterfly</a>
        <a href="Weather.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Weather</a>
    </nav>

    <nav id="rightNav" class="nav-panel fixed right-0 top-0 bottom-0 z-[1001] w-22 shadow-md flex flex-col items-center space-y-6 translate-x-full overflow-y-auto py-20 nav-panel-style">
        <a href="Skill.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Skill</a>
        <a href="Msg.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Message</a>
        <a href="21_Wish.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">21 Wishes</a>
        <a href="Cake.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Cake</a>
        <a href="Periodik_table.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Periodik_table</a>
        <a href="Presence.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Presence</a>
        <a href="Concept.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Concept</a>
        <a href="Calender.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Calender</a>
        <a href="Perspective.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Perspective</a>
        <a href="Spotlight.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Spotlight</a>
        <a href="Room.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Room</a>
        <a href="Radio.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Radio</a>
        <a href="Food.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Food</a>
        <a href="Music.html" class="nav-link p-2 rounded-md text-sm font-medium transition-colors duration-200 festive-text">Music</a>
    </nav>
    
    <main id="mainContent" class="absolute inset-0 pt-28 overflow-y-auto">

        <div id="content-overlay">
            <main class="w-full max-w-4xl p-4 sm:p-6 flex flex-col items-center">
                
                <header class="w-full text-center pb-8 pt-4">
                    <h1 class="text-3xl sm:text-5xl font-black tracking-wider gold-text font-title-serif">
                        The Decuple Stream of Sovereignty
                    </h1>
                    <p class="mt-2 text-lg text-gray-300 italic">
                        The Ten Hands of Power
                    </p>
                </header>

                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 w-full justify-center mb-8">
                    
                    <div id="stream-0" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(0, 'The Warriorâ€™s Edge (Karate)', 'The discipline forged in motion gives you unshakeable confidence. Your strength is your grace and your focus.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #FF4D4D;">Karate</h3>
                        <p class="text-sm text-gray-400">Dynamic Power</p>
                    </div>

                    <div id="stream-1" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(1, 'The Scholarâ€™s Center (Yoga)', 'Your inner focus creates stability amidst life\'s chaos. This calm center allows you to pursue dreams with clarity and peace.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #4287F5;">Yoga</h3>
                        <p class="text-sm text-gray-400">Inner Calm</p>
                    </div>

                    <div id="stream-2" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(2, 'The Future Architect (College)', 'Your hunger for knowledge proves your ambition. Every hour you spend studying is a brick laid for a magnificent future.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #4CAF50;">College</h3>
                        <p class="text-sm text-gray-400">Magnificent Future</p>
                    </div>
                    
                    <div id="stream-3" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(3, 'The Creative Flow (Drawing)', 'Your art is a window into your soulâ€”a vibrant world of colors and ideas. Your creativity inspires everything you touch.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #FFC107;">Drawing</h3>
                        <p class="text-sm text-gray-400">Vibrant Ideas</p>
                    </div>

                    <div id="stream-4" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(4, 'The Zenith of Focus (Olympic Shooting)', 'The stillness required for the perfect shot mirrors your inner calm under pressure. Your precision, patience, and unwavering focus ensure you always hit your mark in life.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #CD7F32;">Shooting</h3>
                        <p class="text-sm text-gray-400">Unwavering Focus</p>
                    </div>
                    
                    <div id="stream-5" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(5, 'The Torchbearerâ€™s Light (Teaching)', 'Your ability to share knowledge and inspire growth illuminates paths for others. The wisdom you impart creates an infinite chain of light.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #00FFFF;">Teaching</h3>
                        <p class="text-sm text-gray-400">Infinite Light</p>
                    </div>

                    <div id="stream-6" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(6, 'The Natural Healer (Tree Medicine)', 'Your connection to nature allows you to harness its quiet strength, providing healing and wisdom to those around you.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #FF9800;">Tree Medicine</h3>
                        <p class="text-sm text-gray-400">Nurturing Wisdom</p>
                    </div>

                    <div id="stream-7" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(7, 'The Voyagerâ€™s Spirit (Seamanship)', 'Like a master of the seas, you navigate lifeâ€™s unpredictable tides with intuition and grace. Your resilience steers you through every storm to new horizons.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #20B2AA;">Seamanship</h3>
                        <p class="text-sm text-gray-400">Steadfast Navigation</p>
                    </div>

                    <div id="stream-8" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(8, 'The Fearless Spirit (Adventure Sports)', 'Whether trekking high peaks or diving from the skies, your courage conquers fear. You embrace challenges with a bold spirit that reaches new heights.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #8E24AA;">Adventure</h3>
                        <p class="text-sm text-gray-400">Boundless Courage</p>
                    </div>

                    <div id="stream-9" class="stream-container rounded-xl p-4 text-center cursor-pointer w-full" 
                        onclick="activateStream(9, 'The Nourishing Heart (Cooking)', 'You feed not just bodies but souls, blending love into every flavor. Your care provides the warmth that sustains us all.')">
                        <h3 class="text-xl font-bold mb-1" style="color: #E91E63;">Cooking</h3>
                        <p class="text-sm text-gray-400">Sustaining Love</p>
                    </div>

                </div>
                
                <div id="message-card" class="message-card w-full p-6 sm:p-8 rounded-xl mt-8 shadow-2xl max-w-md">
                    <h3 id="message-title" class="text-2xl sm:text-3xl font-bold gold-text mb-4 text-center min-h-8">
                        
                    </h3>
                    <p id="typed-message" class="text-lg italic text-gray-300 min-h-24 text-center">
                        
                    </p>
                    
                    <div id="unlock-container" class="mt-6 text-center hidden">
                        <button onclick="checkCompletion()" id="final-button"
                            class="bg-accent-pink hover:bg-red-500 text-white font-bold py-3 px-8 rounded-full text-lg 
                                                 transition duration-300 transform hover:scale-105 shadow-xl disabled:opacity-50 disabled:cursor-not-allowed">
                            See the Final Wish (0/10)
                        </button>
                    </div>
                </div>
                
            </main>
            <div class="h-96 w-full"></div> 
        </div>

        <footer class="text-center py-10 mt-16 bg-transparent text-gray-500 relative z-20">
            <p>Built with ðŸ’–.</p>
        </footer>
    </main>

    <script>
        const NUM_STREAMS = 10;
        const collectedTributes = Array(NUM_STREAMS).fill(false);
        const finalMessage = "Like Ma Durga, you wield ten powers: Discipline, peace, knowledge, creativity, focus, illumination, nurture, navigation, courage, and sustenance. On your birthday, I bow to the divinity within you. Happy Birthday!";
        
        let typingInterval = null;
        let activeMessageIndex = -1;

        const messageCard = document.getElementById('message-card');
        const messageTitle = document.getElementById('message-title');
        const typedMessageElement = document.getElementById('typed-message');
        const finalButton = document.getElementById('final-button');

        const navLinks = document.querySelectorAll('.nav-panel .nav-link');
        const mainContent = document.getElementById('mainContent');
        const topNav = document.getElementById('topNav');
        const bottomNav = document.getElementById('bottomNav');
        const leftNav = document.getElementById('leftNav');
        const rightNav = document.getElementById('rightNav');
        const navToggle = document.getElementById('navToggle');
        const navToggleIcon = document.getElementById('navToggleIcon');
        const navToggleX = document.getElementById('navToggleX');
        let areNavsOpen = false;
        
        function enterExperience() {
            const intro = document.getElementById('intro-screen');
            const content = document.getElementById('content-overlay');
            
            intro.classList.add('hidden-intro');
            content.classList.add('visible-content');
        }

        let scene, camera, renderer, particles, geometry, material;
        let ambientLight;
        const particleCount = 8000;
        const positions = new Float32Array(particleCount * 3);
        const colors = new Float32Array(particleCount * 3);
        const velocities = new Float32Array(particleCount * 3);
        const particleAttributes = [];
        const particleSize = 0.5;
        
        const colorsList = [
            new THREE.Color(0xFF4D4D), 
            new THREE.Color(0x4287F5), 
            new THREE.Color(0x4CAF50), 
            new THREE.Color(0xFFC107), 
            new THREE.Color(0xCD7F32), 
            new THREE.Color(0x00FFFF), 
            new THREE.Color(0xFF9800), 
            new THREE.Color(0x20B2AA), 
            new THREE.Color(0x3F51B5), 
            new THREE.Color(0xE91E63)  
        ];

        let finalExplosionActive = false;
        
        function initThreeJS() {
            const container = document.getElementById('canvas-container');
            const width = window.innerWidth;
            const height = window.innerHeight;

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            
            renderer.setSize(width, height);
            container.appendChild(renderer.domElement);
            camera.position.z = 50;

            ambientLight = new THREE.AmbientLight(0xffffff, 0.1);
            scene.add(ambientLight);

            const pointLight = new THREE.PointLight(0xFFD700, 0, 100);
            pointLight.position.set(0, 0, 0);
            scene.add(pointLight);
            scene.userData.pointLight = pointLight;

            const orbGeometry = new THREE.SphereGeometry(1, 16, 16);
            const orbMaterial = new THREE.MeshBasicMaterial({ color: 0xFFD700, transparent: true, opacity: 0.15, blending: THREE.AdditiveBlending });
            const centralOrb = new THREE.Mesh(orbGeometry, orbMaterial);
            centralOrb.position.set(0, 0, 0);
            scene.add(centralOrb);
            scene.userData.centralOrb = centralOrb;

            geometry = new THREE.BufferGeometry();
            
            for (let i = 0; i < particleCount; i++) {
                positions[i * 3] = (Math.random() - 0.5) * 100;
                positions[i * 3 + 1] = (Math.random() - 0.5) * 100;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 100;
                
                velocities[i * 3] = 0;
                velocities[i * 3 + 1] = 0;
                velocities[i * 3 + 2] = 0;

                const colorIndex = i % NUM_STREAMS;
                const color = colorsList[colorIndex];
                colors[i * 3] = color.r;
                colors[i * 3 + 1] = color.g;
                colors[i * 3 + 2] = color.b;
                
                particleAttributes.push({
                    colorIndex: colorIndex,
                    target: new THREE.Vector3(0, 0, 0),
                    collected: false,
                    velocity: new THREE.Vector3(0, 0, 0),
                    originalPos: new THREE.Vector3(positions[i * 3], positions[i * 3 + 1], positions[i * 3 + 2])
                });
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            geometry.setAttribute('velocity', new THREE.BufferAttribute(velocities, 3));

            material = new THREE.PointsMaterial({
                size: particleSize,
                vertexColors: true,
                blending: THREE.AdditiveBlending,
                transparent: true,
                sizeAttenuation: true
            });

            particles = new THREE.Points(geometry, material);
            scene.add(particles);

            window.addEventListener('resize', onWindowResize, false);
            
            animate();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            particles.rotation.z += 0.0005;
            particles.rotation.x += 0.0002;
            
            const positionAttribute = geometry.attributes.position;
            const velocityAttribute = geometry.attributes.velocity;
            
            const centralOrb = scene.userData.centralOrb;

            if (centralOrb) {
                if (collectedTributes.every(Boolean)) {
                      centralOrb.material.opacity = 0.5 + Math.sin(Date.now() * 0.005) * 0.3;
                      centralOrb.scale.setScalar(2 + Math.sin(Date.now() * 0.003) * 0.3);
                      centralOrb.material.color.set(0xEC4899); 
                } else if (collectedTributes.some(Boolean)) {
                    centralOrb.material.color.set(0xFFD700);
                    centralOrb.material.opacity = 0.4;
                    centralOrb.scale.setScalar(1.2 + Math.sin(Date.now() * 0.008) * 0.1);
                } else {
                    centralOrb.material.color.set(0xFFD700);
                    centralOrb.scale.setScalar(1 + Math.sin(Date.now() * 0.003) * 0.05);
                    centralOrb.material.opacity = 0.15 + Math.cos(Date.now() * 0.001) * 0.05;
                }
            }


            for (let i = 0; i < particleCount; i++) {
                const attr = particleAttributes[i];
                
                if (finalExplosionActive) {
                    positionAttribute.setX(i, positionAttribute.getX(i) + velocityAttribute.getX(i));
                    positionAttribute.setY(i, positionAttribute.getY(i) + velocityAttribute.getY(i));
                    positionAttribute.setZ(i, positionAttribute.getZ(i) + velocityAttribute.getZ(i));
                    
                    material.opacity = Math.max(0, material.opacity - 0.0002);

                } else if (attr.collected) {
                    const currentPos = new THREE.Vector3(
                        positionAttribute.getX(i),
                        positionAttribute.getY(i),
                        positionAttribute.getZ(i)
                    );
                    
                    currentPos.lerp(attr.target, 0.05);
                    
                    positionAttribute.setXYZ(i, currentPos.x, currentPos.y, currentPos.z);
                } else {
                    positionAttribute.setY(i, attr.originalPos.y + Math.sin(Date.now() * 0.001 + i) * 0.5);
                    positionAttribute.setX(i, attr.originalPos.x + Math.cos(Date.now() * 0.001 + i) * 0.5);
                }
            }
            
            positionAttribute.needsUpdate = true;
            renderer.render(scene, camera);
        }

        function activateStream(index, title, message) {
            if (collectedTributes[index]) return; 
            
            if (typingInterval) clearInterval(typingInterval);
            typedMessageElement.textContent = '';
            
            startParticleCollection(index);
            
            collectedTributes[index] = true;
            activeMessageIndex = index;
            
            const count = collectedTributes.filter(Boolean).length;
            finalButton.textContent = `See the Final Wish (${count}/${NUM_STREAMS})`;
            
            messageCard.classList.add('active');
            messageTitle.textContent = title;
            typeMessage(message);
            
            const streamElement = document.getElementById(`stream-${index}`);
            if (collectedTributes[index]) {
                streamElement.classList.remove('cursor-pointer', 'stream-container:hover');
                streamElement.classList.add('opacity-50', 'cursor-default');
                streamElement.onclick = null;
            }
        }
        
        function startParticleCollection(indexToCollect) {
            const centralOrb = scene.userData.centralOrb;
            const collectionTarget = centralOrb ? centralOrb.position : new THREE.Vector3(0, 0, 0);

            for (let i = 0; i < particleCount; i++) {
                const attr = particleAttributes[i];
                if (attr.colorIndex === indexToCollect) {
                    attr.collected = true;
                    attr.target = collectionTarget.clone().add(new THREE.Vector3(
                        (Math.random() - 0.5) * 2,
                        (Math.random() - 0.5) * 2,
                        (Math.random() - 0.5) * 2
                    ));
                }
            }
        }

        function typeMessage(message) {
            let i = 0;
            typedMessageElement.innerHTML = '';
            const cursor = typedMessageElement.appendChild(document.createElement('span'));
            cursor.classList.add('typing-cursor');

            typingInterval = setInterval(() => {
                if (i < message.length) {
                    typedMessageElement.insertBefore(document.createTextNode(message.charAt(i)), cursor);
                    i++;
                } else {
                    clearInterval(typingInterval);
                    if (cursor) cursor.remove();
                    checkCompletion();
                }
            }, 50); 
        }
        
        function checkCompletion() {
            const allCollected = collectedTributes.every(Boolean);
            const container = document.getElementById('unlock-container');
            
            const count = collectedTributes.filter(Boolean).length;
            finalButton.textContent = `See the Final Wish (${count}/${NUM_STREAMS})`;

            if (allCollected) {
                container.classList.remove('hidden');
                finalButton.onclick = startFinalTyping;
                finalButton.textContent = "Unlock FINAL BIRTHDAY WISH!";
            } else {
                 container.classList.remove('hidden');
            }
        }

        function startFinalTyping() {
            finalButton.disabled = true;
            
            messageTitle.textContent = "The Golden Finality";
            typedMessageElement.textContent = '';
            
            startExplosion();
            
            startLightShow();
            
            setTimeout(() => {
                typeFinalMessage(finalMessage);
            }, 1500);
        }
        
        function startExplosion() {
            const velocityAttribute = geometry.attributes.velocity;
            finalExplosionActive = true;
            
            const centralOrb = scene.userData.centralOrb;
            if (centralOrb) centralOrb.visible = false;


            for (let i = 0; i < particleCount; i++) {
                const attr = particleAttributes[i];
                
                if (particleAttributes[i].collected) {
                    geometry.attributes.position.setXYZ(i, 0, 0, 0);

                    const speed = 1.0 + Math.random() * 2.0;
                    const direction = new THREE.Vector3(
                        (Math.random() - 0.5) * 2,
                        (Math.random() - 0.5) * 2,
                        (Math.random() - 0.5) * 2
                    ).normalize().multiplyScalar(speed);

                    velocityAttribute.setXYZ(i, direction.x, direction.y, direction.z);
                    
                    const finalColor = i % 2 === 0 ? colorsList[3] : new THREE.Color('#EC4899');
                    geometry.attributes.color.setXYZ(i, finalColor.r, finalColor.g, finalColor.b);
                } else {
                    geometry.attributes.color.setXYZ(i, 0, 0, 0); 
                }
                
                attr.collected = false; 
            }

            geometry.attributes.position.needsUpdate = true;
            geometry.attributes.color.needsUpdate = true;
            velocityAttribute.needsUpdate = true;
            
            material.opacity = 1; 
        }

        function startLightShow() {
            const pointLight = scene.userData.pointLight;
            
            pointLight.intensity = 5; 
            
            const lightColor = new THREE.Color('#FFD700'); 
            ambientLight.color.set(lightColor);
            ambientLight.intensity = 0.5;

            setTimeout(() => {
                pointLight.intensity = 0;
                ambientLight.intensity = 0.1;
            }, 500);
        }
        
        function typeFinalMessage(message) {
            let i = 0;
            typedMessageElement.innerHTML = '';
            const cursor = typedMessageElement.appendChild(document.createElement('span'));
            cursor.classList.add('typing-cursor');

            typingInterval = setInterval(() => {
                if (i < message.length) {
                    typedMessageElement.insertBefore(document.createTextNode(message.charAt(i)), cursor);
                    i++;
                } else {
                    clearInterval(typingInterval);
                    if (cursor) cursor.remove();
                    
                    messageTitle.classList.add('text-accent-pink', 'animate-pulse');
                }
            }, 60); 
        }
        
        function openAllNavs() {
            topNav.classList.remove('-translate-y-full');
            bottomNav.classList.remove('translate-y-full');
            leftNav.classList.remove('-translate-x-full');
            rightNav.classList.remove('translate-x-full');
            mainContent.classList.add('pt-16', 'pb-16', 'pl-24', 'pr-24');
            mainContent.classList.remove('pt-28'); 
            navToggleIcon.classList.add('hidden');
            navToggleX.classList.remove('hidden');
            areNavsOpen = true;
        }

        function closeAllNavs() {
            topNav.classList.add('-translate-y-full');
            bottomNav.classList.add('translate-y-full');
            leftNav.classList.add('-translate-x-full');
            rightNav.classList.add('translate-x-full');
            mainContent.classList.remove('pt-16', 'pb-16', 'pl-24', 'pr-24');
            mainContent.classList.add('pt-28'); 
            navToggleIcon.classList.remove('hidden');
            navToggleX.classList.add('hidden');
            areNavsOpen = false;
        }

        function toggleAllNavs() {
            if (areNavsOpen) {
                closeAllNavs();
            } else {
                openAllNavs();
            }
        }
        
        window.onload = function() {
            initThreeJS();

            navToggle.addEventListener('click', (e) => {
                e.stopPropagation(); 
                toggleAllNavs();
            });
            
            document.addEventListener('click', (e) => {
                if (areNavsOpen && !e.target.closest('.nav-panel') && !e.target.closest('#navToggle')) {
                    closeAllNavs();
                }
            });

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    const targetHash = e.currentTarget.getAttribute('href');
                    if (areNavsOpen) {
                        if (!targetHash.startsWith('#')) {
                             setTimeout(closeAllNavs, 100); 
                        } else {
                            closeAllNavs();
                        }
                    }
                });
            });
        };

    </script>
</body>
</html>
